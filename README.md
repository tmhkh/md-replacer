# md-replacer

Excelファイル（`replace.xlsx`）に定義された置換ルールに基づいて、複数の Markdown ファイルを一括置換するツールです。  
Jupyter Notebook 上で実行することを想定しています。

## 機能

- `replace.xlsx` の A列（置換前）→ B列（置換後）の置換ペアを読み込み
- `./md` フォルダ内のすべての `.md` ファイルに対して一括置換を実行
- 変更があったファイルのみ上書き保存

## ディレクトリ構成

```
md-replacer/
├── replace_md.py      # メインスクリプト（Jupyter Notebook で実行）
├── replace.xlsx       # 置換定義ファイル（A列: 置換前, B列: 置換後）
├── md/                # 置換対象の .md ファイルを格納するフォルダ
│   ├── example1.md
│   ├── example2.md
│   └── ...
├── LICENSE
└── README.md
```

## 前提条件

- Python 3.x
- Jupyter Notebook
- `openpyxl` ライブラリ

```bash
pip install openpyxl
```

## 使い方

### 1. 置換ルールを定義する

`replace.xlsx` を作成し、以下の形式でデータを入力します。

| A列（置換前） | B列（置換後） |
|---|---|
| 旧テキスト1 | 新テキスト1 |
| 旧テキスト2 | 新テキスト2 |

> ※ 1行目はヘッダー行として扱われます。

### 2. 対象ファイルを配置する

置換対象の `.md` ファイルを `./md` フォルダに配置します。

### 3. スクリプトを実行する

Jupyter Notebook で `replace_md.py` を開き、セルを実行します。

実行結果の例：

```
置換ペア数: 2
  「旧テキスト1」 → 「新テキスト1」
  「旧テキスト2」 → 「新テキスト2」

対象ファイル数: 2
  ./md/example1.md
  ./md/example2.md

✅ example1.md — 3 箇所置換しました
⏭️  example2.md — 置換対象なし（変更なし）

🎉 すべての処理が完了しました。
```

## 設定のカスタマイズ

`replace_md.py` の先頭にある定数を変更することで、動作をカスタマイズできます。

| 定数名 | デフォルト値 | 説明 |
|---|---|---|
| `REPLACE_EXCEL_PATH` | `./replace.xlsx` | 置換定義ファイルのパス |
| `MD_FOLDER_PATH` | `./md` | 対象 .md ファイルのフォルダ |
| `MD_EXTENSION` | `.md` | 対象ファイルの拡張子 |
| `ENCODING` | `utf-8` | .md ファイルのエンコーディング |

## 注意事項

- 置換は **定義順（上から順番）に適用** されるため、順序が結果に影響する場合があります。
- B列が空セルの場合、該当テキストは **空文字（削除）** に置換されます。
- 元ファイルは **上書き保存** されます。必要に応じて事前にバックアップを取ってください。

## ライセンス

[MIT License](LICENSE)